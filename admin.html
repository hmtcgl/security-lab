<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Security Lab</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">üîê Security Lab - Admin</div>
            <ul class="nav-menu">
                <li><a href="index.html">Ana Sayfa</a></li>
                <li><a href="profile.html">Profil</a></li>
                <li><a href="admin.html">Admin Panel</a></li>
                <li><a href="#" onclick="logout()">√áƒ±kƒ±≈ü</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="hero" style="background: linear-gradient(135deg, #dc2626, #991b1b);">
            <h1>‚ö° Admin Control Panel</h1>
            <p class="subtitle">Broken Access Control | Command Injection | Unrestricted File Upload</p>
        </div>

        <div class="alert alert-danger">
            <strong>‚ö†Ô∏è CRITICAL VULNERABILITIES:</strong> This admin panel has NO access control, NO authentication, and allows arbitrary command execution!
        </div>

        <div class="test-categories">
            <!-- User Management -->
            <div class="category-card">
                <h2>üë• User Management</h2>
                <p class="badge badge-danger">No Auth Check!</p>
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="userTable">
                            <tr>
                                <td>1</td>
                                <td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e8898c858186a89c8d9b9cc68b8785">[email&#160;protected]</a></td>
                                <td>admin</td>
                                <td>
                                    <button class="btn btn-danger" onclick="deleteUser(1)">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="621711071022160711164c010d0f">[email&#160;protected]</a></td>
                                <td>user</td>
                                <td>
                                    <button class="btn btn-danger" onclick="deleteUser(2)">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- System Commands (RCE) -->
            <div class="category-card">
                <h2>üíª System Command Execution</h2>
                <p class="badge badge-danger">Command Injection!</p>
                <div class="form-group">
                    <label>Execute System Command:</label>
                    <input type="text" id="cmdInput" placeholder="ls -la" style="width: 100%; font-family: monospace;">
                </div>
                <button class="btn btn-danger" onclick="executeCommand()">Execute</button>
                <div class="code-block" id="cmdOutput" style="margin-top: 1rem; display: none;"></div>
                <div class="alert alert-warning" style="margin-top: 1rem;">
                    <strong>Example commands:</strong><br>
                    - ls -la<br>
                    - cat /etc/passwd<br>
                    - whoami<br>
                    - rm -rf / --no-preserve-root (DON'T ACTUALLY RUN THIS!)
                </div>
            </div>

            <!-- Database Query -->
            <div class="category-card">
                <h2>üóÑÔ∏è Direct Database Access</h2>
                <p class="badge badge-danger">SQL Injection!</p>
                <div class="form-group">
                    <label>SQL Query:</label>
                    <textarea id="sqlInput" rows="3" placeholder="SELECT * FROM users WHERE id = 1" style="width: 100%; font-family: monospace;"></textarea>
                </div>
                <button class="btn btn-danger" onclick="executeSQL()">Execute SQL</button>
                <div class="code-block" id="sqlOutput" style="margin-top: 1rem; display: none;"></div>
            </div>

            <!-- File Manager -->
            <div class="category-card">
                <h2>üìÅ File Manager</h2>
                <p class="badge badge-danger">Path Traversal!</p>
                <div class="form-group">
                    <label>File Path:</label>
                    <input type="text" id="filePath" placeholder="/var/www/config.php" style="width: 100%;">
                </div>
                <button class="btn btn-primary" onclick="readFile()">Read File</button>
                <button class="btn btn-danger" onclick="deleteFile()">Delete File</button>
                <div class="code-block" id="fileContent" style="margin-top: 1rem; display: none;"></div>
                <p style="margin-top: 1rem; color: #6b7280;">
                    Try: ../../../etc/passwd, ../../config/database.yml
                </p>
            </div>

            <!-- Server Configuration -->
            <div class="category-card">
                <h2>‚öôÔ∏è Server Configuration</h2>
                <p class="badge badge-warning">Exposed!</p>
                <div class="code-block">
                    <strong>Database:</strong> postgresql://admin:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3a694f4a5f48695f59485f4e0b08097a5e581453544e5f48545b56">[email&#160;protected]</a>:5432/production<br>
                    <strong>Redis:</strong> redis://:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="90c2f5f4f9e3c0f1e3e3a4a5a6d0f3f1f3f8f5bef9fee4f5e2fef1fc">[email&#160;protected]</a>:6379<br>
                    <strong>S3 Access Key:</strong> AKIAIOSFODNN7EXAMPLE<br>
                    <strong>S3 Secret:</strong> wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY<br>
                    <strong>JWT Secret:</strong> super-secret-jwt-key-production<br>
                    <strong>API Key:</strong> sk-prod-live-12345-vulnerable<br>
                    <strong>Admin Password:</strong> Admin2024!Secure<br>
                </div>
            </div>

            <!-- Log Viewer -->
            <div class="category-card">
                <h2>üìã System Logs</h2>
                <p class="badge badge-danger">Information Disclosure!</p>
                <button class="btn btn-primary" onclick="viewLogs()">View Logs</button>
                <div class="code-block" id="logOutput" style="margin-top: 1rem; display: none;"></div>
            </div>

            <!-- API Key Generator -->
            <div class="category-card">
                <h2>üîë API Key Generator</h2>
                <p class="badge badge-warning">Weak Randomness!</p>
                <button class="btn btn-primary" onclick="generateAPIKey()">Generate Key</button>
                <div id="apiKeyOutput" style="margin-top: 1rem;"></div>
            </div>

            <!-- Backup & Restore -->
            <div class="category-card">
                <h2>üíæ Backup & Restore</h2>
                <button class="btn btn-success" onclick="createBackup()">Create Backup</button>
                <button class="btn btn-warning" onclick="restoreBackup()">Restore Backup</button>
                <button class="btn btn-danger" onclick="deleteBackups()">Delete All Backups</button>
                <div id="backupResult" style="margin-top: 1rem;"></div>
            </div>

            <!-- Server Control -->
            <div class="category-card">
                <h2>üñ•Ô∏è Server Control</h2>
                <p class="badge badge-danger">No Protection!</p>
                <button class="btn btn-danger" onclick="restartServer()">Restart Server</button>
                <button class="btn btn-danger" onclick="shutdownServer()">Shutdown Server</button>
                <button class="btn btn-warning" onclick="clearCache()">Clear Cache</button>
                <div id="serverResult" style="margin-top: 1rem;"></div>
            </div>
        </div>

        <!-- Active Sessions -->
        <div class="data-table" style="margin-top: 2rem;">
            <h3 style="padding: 1rem;">üë§ Active Sessions</h3>
            <table>
                <thead>
                    <tr>
                        <th>User</th>
                        <th>IP Address</th>
                        <th>Session Token</th>
                        <th>Started</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3d5c595054537d49584e49135e5250">[email&#160;protected]</a></td>
                        <td>192.168.1.100</td>
                        <td>YWRtaW5AdGVzdC5jb206MTcwNTUwMDAwMDAw</td>
                        <td>2024-01-15 10:30:45</td>
                        <td><button class="btn btn-danger">Terminate</button></td>
                    </tr>
                    <tr>
                        <td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="225751475062564751560c414d4f">[email&#160;protected]</a></td>
                        <td>10.0.0.50</td>
                        <td>dXNlckB0ZXN0LmNvbToxNzA1NTAwMDAwMDA=</td>
                        <td>2024-01-15 11:15:22</td>
                        <td><button class="btn btn-danger">Terminate</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <footer>
        <p>üîì Deliberately Vulnerable Admin Panel</p>
        <p>‚ö†Ô∏è Access Control: NONE | Authentication: BYPASSED | Authorization: MISSING</p>
    </footer>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="js/auth.js"></script>
    <script>
        // Vulnerable: No authentication check at all!
        console.log('‚ö†Ô∏è WARNING: Admin panel loaded without authentication!');
        console.log('Anyone can access this page!');

        // Vulnerable: Command execution simulation
        function executeCommand() {
            const cmd = document.getElementById('cmdInput').value;
            
            // Simulate command execution (in reality this would be RCE)
            const simulatedOutput = `
$ ${cmd}
Executing command...

‚ö†Ô∏è In a real scenario, this would execute: ${cmd}

Simulated output:
total 48
drwxr-xr-x  5 www-data www-data 4096 Jan 15 10:30 .
drwxr-xr-x 15 root     root     4096 Jan 14 08:00 ..
-rw-r--r--  1 www-data www-data  220 Jan 10 12:00 .bash_logout
-rw-r--r--  1 www-data www-data 3526 Jan 10 12:00 .bashrc
-rw-r--r--  1 www-data www-data  807 Jan 10 12:00 .profile
-rw-r--r--  1 www-data www-data 1234 Jan 15 10:30 config.php
-rw-------  1 www-data www-data  456 Jan 15 10:30 .env

Command completed with exit code: 0
            `;

            document.getElementById('cmdOutput').textContent = simulatedOutput;
            document.getElementById('cmdOutput').style.display = 'block';
        }

        // Vulnerable: SQL injection
        function executeSQL() {
            const sql = document.getElementById('sqlInput').value;
            
            const simulatedResult = `
Query: ${sql}

Results:
+----+------------------+----------+----------+---------------+
| id | email            | password | role     | ssn           |
+----+------------------+----------+----------+---------------+
|  1 | admin@test.com   | Admin123!| admin    | 123-45-6789   |
|  2 | user@test.com    | User123! | user     | 987-65-4321   |
|  3 | test@test.com    | Test123! | user     | 555-12-3456   |
+----+------------------+----------+----------+---------------+

3 rows returned
Query executed successfully
            `;

            document.getElementById('sqlOutput').textContent = simulatedResult;
            document.getElementById('sqlOutput').style.display = 'block';
        }

        // Vulnerable: Path traversal
        function readFile() {
            const path = document.getElementById('filePath').value;
            
            const fileContents = {
                '/etc/passwd': 'root:x:0:0:root:/root:/bin/bash\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin',
                '../../../etc/passwd': 'root:x:0:0:root:/root:/bin/bash\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin',
                '/var/www/config.php': '<?php\n$db_host = "localhost";\n$db_user = "admin";\n$db_pass = "SuperSecret123";\n$db_name = "production";\n?>',
                'default': `File: ${path}\n\n<?php\n// Configuration file\ndefine('DB_HOST', 'db.internal');\ndefine('DB_USER', 'admin');\ndefine('DB_PASS', 'SuperSecret123');\ndefine('API_KEY', 'sk-prod-12345');\n?>`
            };

            const content = fileContents[path] || fileContents['default'];
            document.getElementById('fileContent').textContent = content;
            document.getElementById('fileContent').style.display = 'block';
        }

        function deleteFile() {
            const path = document.getElementById('filePath').value;
            alert(`‚ö†Ô∏è File deleted: ${path}\n\n(Simulated - in reality this would delete the file!)`);
        }

        function viewLogs() {
            const logs = `
[2024-01-15 10:30:45] LOGIN admin@test.com from 192.168.1.100 - SUCCESS
[2024-01-15 10:31:12] API_CALL /api/users - API_KEY: sk-prod-12345 - SUCCESS
[2024-01-15 10:32:30] DATABASE_QUERY SELECT * FROM users WHERE role='admin'
[2024-01-15 10:33:45] PASSWORD_CHANGE user@test.com - NEW_PASS: NewPass123!
[2024-01-15 10:35:20] ADMIN_ACTION delete_user id=5 by admin@test.com
[2024-01-15 10:36:10] ERROR SQL_INJECTION_ATTEMPT ' OR '1'='1 from 10.0.0.99
[2024-01-15 10:37:45] LOGIN_FAILED test@test.com - WRONG_PASSWORD: WrongPass456
[2024-01-15 10:38:30] SESSION_TOKEN_GENERATED admin@test.com - TOKEN: YWRtaW5AdGVzdC5jb206MTcwNTUwMDAwMDAw
            `;

            document.getElementById('logOutput').textContent = logs;
            document.getElementById('logOutput').style.display = 'block';
        }

        function generateAPIKey() {
            // Vulnerable: Weak random generation
            const key = 'sk-' + Math.random().toString(36).substring(2, 15);
            document.getElementById('apiKeyOutput').innerHTML = `
                <div class="alert alert-success">
                    <strong>New API Key Generated:</strong><br>
                    <code>${key}</code><br>
                    <small>‚ö†Ô∏è Weak randomness! Predictable!</small>
                </div>
            `;
        }

        function createBackup() {
            document.getElementById('backupResult').innerHTML = `
                <div class="alert alert-success">
                    ‚úÖ Backup created: backup_2024_01_15_103045.sql<br>
                    Location: /var/backups/backup_2024_01_15_103045.sql<br>
                    <a href="/backups/backup_2024_01_15_103045.sql" class="btn btn-primary" style="margin-top: 0.5rem;">Download</a>
                </div>
            `;
        }

        function restoreBackup() {
            document.getElementById('backupResult').innerHTML = `
                <div class="alert alert-warning">
                    ‚ö†Ô∏è Restoring backup... This will overwrite all data!<br>
                    Database restored from: backup_2024_01_14_080000.sql
                </div>
            `;
        }

        function deleteBackups() {
            document.getElementById('backupResult').innerHTML = `
                <div class="alert alert-danger">
                    üóëÔ∏è All backups deleted permanently!<br>
                    Files removed: 15 backup files (2.3 GB)
                </div>
            `;
        }

        function deleteUser(userId) {
            if (confirm(`Delete user ID ${userId}? This cannot be undone!`)) {
                alert(`User ${userId} deleted successfully!`);
            }
        }

        function restartServer() {
            document.getElementById('serverResult').innerHTML = `
                <div class="alert alert-danger">
                    üîÑ Server restarting...<br>
                    All active sessions will be terminated.<br>
                    Estimated downtime: 30 seconds
                </div>
            `;
        }

        function shutdownServer() {
            if (confirm('‚ö†Ô∏è WARNING: This will shut down the entire server! Continue?')) {
                document.getElementById('serverResult').innerHTML = `
                    <div class="alert alert-danger">
                        üõë SERVER SHUTTING DOWN<br>
                        Goodbye...
                    </di